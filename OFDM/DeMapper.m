function [ OutputBits ] = DeMapper( UsedF, Nsk )

    switch Nsk
        case 4 % QPSK
            Dictionary = [ 1+1j 1-1j -1+1j -1-1j ].';
        case 16 % 16-QAM
            Dictionary = [ 3+3j 3+1j 1+3j 1+1j 3-3j 3-1j 1-3j 1-1j...
                          -3+3j -3+1j -1+3j -1+1j -3-3j -3-1j -1-3j -1-1j].';
        case 64 % 64-QAM
            Dictionary = [ 7+7j 7+5j 5+7j 5+5j 7+1j 7+3j 5+1j 5+3j 1+7j...
                           1+5j 3+7j 3+5j 1+1j 1+3j 3+1j 3+3j...
                           7-7j 7-5j 5-7j 5-5j 7-1j 7-3j 5-1j 5-3j 1-7j...
                           1-5j 3-7j 3-5j 1-1j 1-3j 3-1j 3-3j...
                           -7+7j -7+5j -5+7j -5+5j -7+1j -7+3j -5+1j...
                           -5+3j...
                           -1+7j -1+5j -3+7j -3+5j -1+1j -1+3j -3+1j...
                           -3+3j...
                           -7-7j -7-5j -5-7j -5-5j -7-1j -7-3j -5-1j...
                           -5-3j -1-7j -1-5j -3-7j -3-5j -1-1j -1-3j...
                           -3-1j -3-3j].';
    end
    [Size1, Size2] = size(UsedF);
    LengthMed = Size1 * Size2;
    Med = reshape (UsedF.', 1, LengthMed);
    for k = 1 : length(Med)
        a = Med(k).*ones(length(Dictionary), 1);
        [a1, Numb] = min(a - Dictionary);
        BinaryArray(:,k) = de2bi(Numb-1,log2(Nsk), 'left-msb');
    end
    z=0;
    OutputBits = reshape(BinaryArray, 1, log2(Nsk)*length(Med));
end

